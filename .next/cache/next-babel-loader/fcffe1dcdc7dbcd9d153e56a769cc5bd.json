{"ast":null,"code":"var __jsx = React.createElement;\nimport Head from \"next/head\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport Translator from \"../lang\";\n\nconst TextInput = ({\n  type,\n  name,\n  label,\n  onChange,\n  placeholder,\n  value,\n  error\n}) => {\n  let wrapperClass = 'form-group';\n\n  if (error && error.length > 0) {\n    wrapperClass += \" \" + 'has-error';\n  }\n\n  return __jsx(\"div\", {\n    className: wrapperClass\n  }, __jsx(\"label\", {\n    htmlFor: name\n  }, label), __jsx(\"div\", {\n    className: \"field\"\n  }, __jsx(\"input\", {\n    type: type,\n    name: name,\n    className: \"form-control input-lg\",\n    placeholder: placeholder,\n    value: value,\n    onChange: onChange\n  }), error && __jsx(\"div\", {\n    className: \"alert alert-danger\"\n  }, error)));\n};\n\nclass Register extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      preMobile: \"\",\n      mobile: \"\",\n      invitation_code: \"\",\n      country: \"en\"\n    };\n    this.onChange = this.onChange.bind(this);\n    this.onChangeCountry = this.onChangeCountry.bind(this);\n    this.submitForm = this.submitForm.bind(this);\n    this.formIsValid = this.formIsValid.bind(this);\n  }\n\n  componentDidMount() {\n    let urlPath = window.location.search;\n    let components = urlPath.split(\"=\");\n\n    if (components.length > 1) {\n      this.setState({\n        invitation_code: components[1]\n      });\n    }\n  }\n\n  onChange(e) {\n    return this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  onChangeCountry(e) {\n    e.preventDefault();\n    this.setState({\n      preMobile: e.target.value\n    });\n\n    if (e.target.value === \"+81\") {\n      Translator.setPackage(\"jp\");\n      this.setState({\n        country: \"jp\"\n      });\n    } else if (e.target.value === \"+82\") {\n      Translator.setPackage(\"ko\");\n      this.setState({\n        country: \"ko\"\n      });\n    } else if (e.target.value === \"+86\") {\n      Translator.setPackage(\"zh\");\n      this.setState({\n        country: \"zh\"\n      });\n    } else {\n      Translator.setPackage(\"en\");\n      this.setState({\n        country: \"jp\"\n      });\n    }\n  }\n\n  formIsValid() {\n    let isValid = true;\n\n    if (this.state.mobile.length < 10) {\n      isValid = false;\n      alert(Translator.getT(\"phoneformatwrong\"));\n    }\n\n    return isValid;\n  }\n\n  submitForm(e) {\n    e.preventDefault();\n\n    if (this.formIsValid()) {\n      axios.post(\"http://cicoins.io:8999/api/app/verify/signUpCode\", {\n        mobile: this.state.mobile,\n        preMobile: this.state.preMobile\n      }).then(res => {\n        let resBody = res.data;\n\n        if (resBody.code === 5009) {\n          alert(Translator.getT(\"phoneexist\"));\n        } else if (resBody.code === 0) {\n          alert(Translator.getT(\"sendcodeok\"));\n          window.location.href = \"/signup?invitation=\" + this.state.invitation_code + \"&preMobile=\" + this.state.preMobile + \"&mobile=\" + this.state.mobile + \"&lang=\" + this.state.country;\n        } else {\n          alert(Translator.getT(\"cannotregister\"));\n        }\n      });\n    }\n  }\n\n  render() {\n    return __jsx(\"div\", null, __jsx(\"div\", {\n      className: \"Register\"\n    }, __jsx(\"h2\", null, \"CAIC\"), __jsx(\"h4\", null, \"Welcome to CAIC world\"), __jsx(\"form\", {\n      onSubmit: this.submitForm\n    }, __jsx(\"div\", {\n      className: \"form-group\"\n    }, __jsx(\"label\", null, Translator.getT(\"country\")), __jsx(\"div\", {\n      className: \"field input-lg\"\n    }, __jsx(\"select\", {\n      onChange: this.onChangeCountry\n    }, __jsx(\"option\", {\n      value: \"\"\n    }, \"Select Country\"), __jsx(\"option\", {\n      value: \"+82\"\n    }, \"Korea\"), __jsx(\"option\", {\n      value: \"+81\"\n    }, \"Japan\"), __jsx(\"option\", {\n      value: \"+86\"\n    }, \"China\")))), __jsx(TextInput, {\n      type: \"text\",\n      label: Translator.getT(\"cellphone\"),\n      name: \"mobile\",\n      value: this.state.mobile,\n      placeholder: Translator.getT(\"cellphone\"),\n      onChange: this.onChange,\n      errors: null\n    }), __jsx(\"input\", {\n      type: \"submit\",\n      value: Translator.getT(\"sendcode\"),\n      className: \"btn btn-primary btn-lg\"\n    }))));\n  }\n\n}\n\n;\nexport default class Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return __jsx(\"div\", null, __jsx(Head, null, __jsx(\"title\", null, \"CAIC\"), __jsx(\"link\", {\n      href: \"https://caicsignup.s3-ap-northeast-1.amazonaws.com/main.css\",\n      rel: \"stylesheet\"\n    }), __jsx(\"link\", {\n      href: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css\",\n      rel: \"stylesheet\"\n    })), __jsx(Register, null));\n  }\n\n}\n;","map":null,"metadata":{},"sourceType":"module"}