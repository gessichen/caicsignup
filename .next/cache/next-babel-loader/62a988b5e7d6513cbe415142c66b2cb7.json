{"ast":null,"code":"var __jsx = React.createElement;\nimport Head from \"next/head\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport Translator from \"../lang\";\n\nconst TextInput = ({\n  type,\n  name,\n  label,\n  onChange,\n  placeholder,\n  value,\n  error\n}) => {\n  let wrapperClass = 'form-group';\n\n  if (error && error.length > 0) {\n    wrapperClass += \" \" + 'has-error';\n  }\n\n  return __jsx(\"div\", {\n    className: wrapperClass\n  }, __jsx(\"label\", {\n    htmlFor: name\n  }, label), __jsx(\"div\", {\n    className: \"field\"\n  }, __jsx(\"input\", {\n    type: type,\n    name: name,\n    className: \"form-control input-lg\",\n    placeholder: placeholder,\n    value: value,\n    onChange: onChange\n  }), error && __jsx(\"div\", {\n    className: \"alert alert-danger\"\n  }, error)));\n};\n\nclass UserInfo extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      verification_code: \"\",\n      invitation_code: \"\",\n      password: \"\",\n      user_name: \"\",\n      mobile: \"\",\n      preMobile: \"\",\n      country: \"en\"\n    };\n    this.onChange = this.onChange.bind(this);\n    this.submitForm = this.submitForm.bind(this);\n    this.formIsValid = this.formIsValid.bind(this);\n  }\n\n  componentDidMount() {\n    let urlPath = window.location.search; //alert(urlPath);\n\n    let components = urlPath.split(\"&\");\n\n    if (components.length !== 4) {\n      window.location.href = \"/\";\n    } else {\n      let invitation = components[0].split(\"=\")[1];\n      let preMobile = components[1].split(\"=\")[1];\n      let mobile = components[2].split(\"=\")[1];\n      let country = components[3].split(\"=\")[1];\n      Translator.setPackage(country);\n      this.setState({\n        invitation_code: invitation,\n        mobile: mobile,\n        preMobile: preMobile,\n        country: country\n      });\n    }\n  }\n\n  onChange(e) {\n    return this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  formIsValid() {\n    let isValid = true;\n\n    if (this.state.password.length < 8) {\n      alert(Translator.getT(\"passwordatleast8\"));\n      return false;\n    }\n\n    if (this.state.user_name.trim().length === 0) {\n      alert(Translator.getT(\"cannotregister\"));\n      return false;\n    }\n\n    if (this.state.invitation_code.trim().length === 0) {\n      alert(Translator.getT(\"cannotregister\"));\n      return false;\n    }\n\n    if (this.state.verification_code.trim().length === 0) {\n      alert(Translator.getT(\"cannotregister\"));\n      return false;\n    }\n\n    return isValid;\n  }\n\n  submitForm(e) {\n    e.preventDefault();\n\n    if (this.formIsValid()) {\n      axios.post(\"http://cicoins.io:8999/api/app/user/register\", {\n        \"preMobile\": this.state.preMobile,\n        \"mobile\": this.state.mobile,\n        \"userName\": this.state.user_name,\n        \"password\": this.state.password,\n        \"code\": this.state.verification_code,\n        \"inviteCode\": this.state.invitation_code\n      }).then(res => {\n        let data = res.data;\n\n        if (data.code === 0) {\n          window.location = \"/finish?lang=\" + this.state.country;\n        } else {\n          alert(Translator.getT(\"cannotregister\"));\n        }\n      });\n    }\n  }\n\n  render() {\n    return __jsx(\"div\", null, __jsx(\"div\", {\n      className: \"Register\"\n    }, __jsx(\"h2\", null, \"CAIC\"), __jsx(\"h4\", null, Translator.getT(\"userinfo\")), __jsx(\"form\", {\n      onSubmit: this.submitForm\n    }, __jsx(TextInput, {\n      type: \"text\",\n      label: Translator.getT(\"verificationcode\"),\n      name: \"verification_code\",\n      value: this.state.verification_code,\n      placeholder: Translator.getT(\"verificationcode\"),\n      onChange: this.onChange,\n      errors: null\n    }), __jsx(TextInput, {\n      type: \"text\",\n      label: Translator.getT(\"username\"),\n      name: \"user_name\",\n      value: this.state.user_name,\n      placeholder: Translator.getT(\"username\"),\n      onChange: this.onChange,\n      errors: null\n    }), __jsx(TextInput, {\n      type: \"password\",\n      label: Translator.getT(\"password\"),\n      name: \"password\",\n      value: this.state.password,\n      placeholder: Translator.getT(\"password\"),\n      onChange: this.onChange,\n      errors: null\n    }), __jsx(TextInput, {\n      type: \"text\",\n      label: Translator.getT(\"invitationcode\"),\n      name: \"invitation_code\",\n      value: this.state.invitation_code,\n      placeholder: Translator.getT(\"invitationcode\"),\n      onChange: this.onChange,\n      errors: null\n    }), __jsx(\"input\", {\n      type: \"submit\",\n      value: Translator.getT(\"register\"),\n      className: \"btn btn-primary btn-lg\"\n    }))));\n  }\n\n}\n\n;\nexport default class Signup extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return __jsx(\"div\", null, __jsx(Head, null, __jsx(\"title\", null, \"CAIC\"), __jsx(\"link\", {\n      href: \"https://caicsignup.s3-ap-northeast-1.amazonaws.com/main.css\",\n      rel: \"stylesheet\"\n    }), __jsx(\"link\", {\n      href: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css\",\n      rel: \"stylesheet\"\n    })), __jsx(UserInfo, null));\n  }\n\n}\n;","map":null,"metadata":{},"sourceType":"module"}